<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.maritime.dao.SCMappingMapper">
  <resultMap id="BaseResultMap" type="com.maritime.models.SCMapping">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 19 22:55:14 CST 2017.
    -->
    <id column="pid" jdbcType="INTEGER" property="pid" />
    <result column="pcid" jdbcType="INTEGER" property="pcid" />
    <result column="psid" jdbcType="INTEGER" property="psid" />
    <result column="start_dt" jdbcType="TIMESTAMP" property="startDt" />
    <result column="finish_dt" jdbcType="TIMESTAMP" property="finishDt" />
    <result column="pterm" jdbcType="VARCHAR" property="pterm" />
    <result column="is_active" jdbcType="BIT" property="isActive" />
    <result column="pdescription" jdbcType="VARCHAR" property="pdescription" />
    <result column="last_update_user" jdbcType="VARCHAR" property="lastUpdateUser" />
    <result column="last_update_dt" jdbcType="TIMESTAMP" property="lastUpdateDt" />

    <result column="course" jdbcType="VARCHAR" property="course" />
    <result column="cnumber" jdbcType="BIGINT" property="cnumber" />
    <result column="teacher" jdbcType="VARCHAR" property="teacher" />
    <result column="academy" jdbcType="VARCHAR" property="academy" />
    <result column="category" jdbcType="VARCHAR" property="category" />
    <result column="type" jdbcType="VARCHAR" property="type" />
    <result column="point" jdbcType="REAL" property="point" />
    <result column="hour" jdbcType="INTEGER" property="hour" />
    <result column="examtype" jdbcType="VARCHAR" property="examtype" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 19 22:55:14 CST 2017.
    -->
    pid, pcid, psid, start_dt, finish_dt, pterm, is_active, pdescription, last_update_user, 
    last_update_dt,frequency
  </sql>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 19 22:55:14 CST 2017.
    -->
    select 
    <include refid="Base_Column_List" />
    from maritime.scmapping
    where pid = #{pid,jdbcType=INTEGER}
  </select>
  <select id="selectAllCourse" parameterType="java.lang.Long" resultMap="BaseResultMap">
    select map.pterm,c.coname as course,c.conumber as cnumber,t.tname as teacher,
    a.aname as academy,cate.ldvalue as category,type.ldvalue as type,c.copoint as point,
    c.cohour as hour,examt.ldvalue as examtype
    from maritime.scmapping map
    inner join maritime.course c on map.pcid = c.coid and c.is_active = true
    left join maritime.teacher t on c.coteacher1 = t.tid and t.is_active = true
    left join maritime.academy a on c.coacademy = a.aid
    left join maritime.listdata cate on c.cocategory = cate.ldid
    left join maritime.listdata type on c.cotype = type.ldid
    left join maritime.listdata examt on c.coexamtype = examt.ldid
    where map.psid = #{psid,jdbcType=BIGINT} and map.is_active = true
    order by map.pterm desc
  </select>
    <select id="selectAllCourseForTeacher" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select map.sterm as pterm,c.coname as course,c.conumber as cnumber,t.tname as teacher,
        a.aname as academy,cate.ldvalue as category,type.ldvalue as type,c.copoint as point,
        c.cohour as hour,examt.ldvalue as examtype
        from maritime.course c
        left join maritime.schedule map on map.scid = c.coid and map.is_active = true
        left join maritime.teacher t on c.coteacher1 = t.tid and t.is_active = true
        left join maritime.academy a on c.coacademy = a.aid
        left join maritime.listdata cate on c.cocategory = cate.ldid
        left join maritime.listdata type on c.cotype = type.ldid
        left join maritime.listdata examt on c.coexamtype = examt.ldid
        where c.coteacher1 =  #{tid,jdbcType=BIGINT} and c.is_active = true
        order by map.sterm desc
    </select>
    <select id="selectAllTermsForStudent" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select distinct pterm from maritime.scmapping
        where psid = #{sid,jdbcType=BIGINT} and is_active = true
        order by pterm
    </select>
    <select id="selectAllTermsForTeacher" parameterType="java.lang.Long" resultMap="BaseResultMap">
        select distinct sterm as pterm
        from maritime.schedule p
        left join maritime.course c on p.scid = c.coid and c.is_active = true
        where c.coteacher1 = #{tid,jdbcType=BIGINT} and p.is_active = true
        order by sterm
    </select>
    <select id="selectAllTermsForAdmin" resultMap="BaseResultMap">
        select distinct sterm as pterm
        from maritime.schedule p
        where p.is_active = true
        order by sterm
    </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 19 22:55:14 CST 2017.
    -->
    delete from maritime.scmapping
    where pid = #{pid,jdbcType=INTEGER}
  </delete>
  <insert id="insert" parameterType="com.maritime.models.SCMapping">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 19 22:55:14 CST 2017.
    -->
    insert into maritime.scmapping (pcid, psid,
      start_dt, finish_dt, pterm, 
      is_active, pdescription, last_update_user, 
      last_update_dt)
    values (#{pcid,jdbcType=INTEGER}, #{psid,jdbcType=INTEGER},
      #{startDt,jdbcType=TIMESTAMP}, #{finishDt,jdbcType=TIMESTAMP}, #{pterm,jdbcType=VARCHAR}, 
      #{isActive,jdbcType=BIT}, #{pdescription,jdbcType=VARCHAR}, #{lastUpdateUser,jdbcType=VARCHAR}, 
      #{lastUpdateDt,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.maritime.models.SCMapping">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 19 22:55:14 CST 2017.
    -->
    insert into maritime.scmapping
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="pid != null">
        pid,
      </if>
      <if test="pcid != null">
        pcid,
      </if>
      <if test="psid != null">
        psid,
      </if>
      <if test="startDt != null">
        start_dt,
      </if>
      <if test="finishDt != null">
        finish_dt,
      </if>
      <if test="pterm != null">
        pterm,
      </if>
      <if test="isActive != null">
        is_active,
      </if>
      <if test="pdescription != null">
        pdescription,
      </if>
      <if test="lastUpdateUser != null">
        last_update_user,
      </if>
      <if test="lastUpdateDt != null">
        last_update_dt,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="pid != null">
        #{pid,jdbcType=INTEGER},
      </if>
      <if test="pcid != null">
        #{pcid,jdbcType=INTEGER},
      </if>
      <if test="psid != null">
        #{psid,jdbcType=INTEGER},
      </if>
      <if test="startDt != null">
        #{startDt,jdbcType=TIMESTAMP},
      </if>
      <if test="finishDt != null">
        #{finishDt,jdbcType=TIMESTAMP},
      </if>
      <if test="pterm != null">
        #{pterm,jdbcType=VARCHAR},
      </if>
      <if test="isActive != null">
        #{isActive,jdbcType=BIT},
      </if>
      <if test="pdescription != null">
        #{pdescription,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdateUser != null">
        #{lastUpdateUser,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdateDt != null">
        #{lastUpdateDt,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.maritime.models.SCMapping">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 19 22:55:14 CST 2017.
    -->
    update maritime.scmapping
    <set>
      <if test="pcid != null">
        pcid = #{pcid,jdbcType=INTEGER},
      </if>
      <if test="psid != null">
        psid = #{psid,jdbcType=INTEGER},
      </if>
      <if test="startDt != null">
        start_dt = #{startDt,jdbcType=TIMESTAMP},
      </if>
      <if test="finishDt != null">
        finish_dt = #{finishDt,jdbcType=TIMESTAMP},
      </if>
      <if test="pterm != null">
        pterm = #{pterm,jdbcType=VARCHAR},
      </if>
      <if test="isActive != null">
        is_active = #{isActive,jdbcType=BIT},
      </if>
      <if test="pdescription != null">
        pdescription = #{pdescription,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdateUser != null">
        last_update_user = #{lastUpdateUser,jdbcType=VARCHAR},
      </if>
      <if test="lastUpdateDt != null">
        last_update_dt = #{lastUpdateDt,jdbcType=TIMESTAMP},
      </if>
    </set>
    where pid = #{pid,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.maritime.models.SCMapping">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed Apr 19 22:55:14 CST 2017.
    -->
    update maritime.scmapping
    set pcid = #{pcid,jdbcType=INTEGER},
      psid = #{psid,jdbcType=INTEGER},
      start_dt = #{startDt,jdbcType=TIMESTAMP},
      finish_dt = #{finishDt,jdbcType=TIMESTAMP},
      pterm = #{pterm,jdbcType=VARCHAR},
      is_active = #{isActive,jdbcType=BIT},
      pdescription = #{pdescription,jdbcType=VARCHAR},
      last_update_user = #{lastUpdateUser,jdbcType=VARCHAR},
      last_update_dt = #{lastUpdateDt,jdbcType=TIMESTAMP}
    where pid = #{pid,jdbcType=INTEGER}
  </update>
    <update id="inactiveScmapping" parameterType="java.lang.Integer">
        update maritime.scmapping
        set is_active = FALSE
        where pid in
        <foreach item="pids" collection="array" open="("
                 separator="," close=")">
            #{pids}
        </foreach>
    </update>
</mapper>